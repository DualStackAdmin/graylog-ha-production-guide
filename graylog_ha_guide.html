<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale-1.0">
    <title>Graylog 3-Node HA Guide (Prod, 32GB RAM)</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts (Inter) -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for code blocks */
        pre {
            position: relative;
            background-color: #1f2937; /* bg-gray-800 */
            color: #f9fafb; /* text-gray-50 */
            padding: 1rem;
            padding-top: 2.5rem; /* Extra padding for the button */
            border-radius: 0.5rem; /* rounded-lg */
            overflow-x: auto;
            margin-top: 1rem;
            margin-bottom: 1rem;
            font-family: 'Courier New', Courier, monospace;
        }
        pre code {
            white-space: pre;
        }
        .copy-btn {
            position: absolute;
            top: 0.5rem;
            right: 0.5rem;
            background-color: #4b5563; /* bg-gray-600 */
            color: white;
            border: none;
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            font-size: 0.875rem;
            cursor: pointer;
            opacity: 0.7;
            transition: all 0.2s;
        }
        pre:hover .copy-btn {
            opacity: 1;
        }
        .copy-btn:hover {
            background-color: #6b7280; /* bg-gray-500 */
        }
        .copy-success {
            background-color: #10b981 !important; /* bg-green-500 */
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">

    <div class="max-w-4xl mx-auto p-4 sm:p-8 bg-white shadow-xl rounded-lg my-8 ring-1 ring-gray-200">
        
        <!-- Header -->
        <h1 class="text-3xl font-bold text-gray-900 mb-4">üöÄ Graylog 3-Node HA Guide (Prod Environment, 32GB RAM)</h1>
        <p class="text-gray-600 mb-6">This guide covers the process of setting up a Graylog cluster in High Availability (HA) mode on 3 servers. It assumes each server has 32GB of RAM and all three components (MongoDB, Data Node, Server) are running on the same machine.</p>

        <!-- Table of Contents -->
        <div class="bg-blue-50 p-6 rounded-lg mb-8 border border-blue-200">
            <h2 class="text-2xl font-semibold mb-3 text-blue-800">üó∫Ô∏è Table of Contents</h2>
            <ul class="space-y-2 list-inside">
                <li><a href="#server-info" class="text-blue-600 hover:underline">Server Information</a></li>
                <li><a href="#stage-1" class="text-blue-600 hover:underline">STAGE 1: Basic System Preparation</a></li>
                <li><a href="#stage-2" class="text-blue-600 hover:underline">STAGE 2: MongoDB Cluster Setup</a></li>
                <li><a href="#stage-3" class="text-blue-600 hover:underline">STAGE 3: Graylog Data Node Installation</a></li>
                <li><a href="#stage-4" class="text-blue-600 hover:underline">STAGE 4: Graylog Server Installation</a></li>
                <li><a href="#stage-5" class="text-blue-600 hover:underline">STAGE 5: Final Setup and Test</a></li>
            </ul>
        </div>

        <!-- Server Info Section -->
        <section id="server-info" class="mb-12">
            <h2 class="text-2xl font-semibold border-b pb-2 mb-4 text-gray-800">‚ÑπÔ∏è Server Information</h2>
            <p class="mb-4">The following server names and IP addresses will be used throughout the installation:</p>
            <div class="overflow-x-auto rounded-lg border border-gray-200">
                <table class="min-w-full bg-white">
                    <thead class="bg-gray-50">
                        <tr>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Server</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Hostname</th>
                            <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">IP Address</th>
                        </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">Node 1</td>
                            <td class="px-6 py-4 whitespace-nowrap font-mono text-sm bg-gray-100 rounded">&lt;NODE1_HOSTNAME&gt;</td>
                            <td class="px-6 py-4 whitespace-nowrap font-mono text-sm bg-gray-100 rounded">&lt;NODE1_IP&gt;</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">Node 2</td>
                            <td class="px-6 py-4 whitespace-nowrap font-mono text-sm bg-gray-100 rounded">&lt;NODE2_HOSTNAME&gt;</td>
                            <td class="px-6 py-4 whitespace-nowrap font-mono text-sm bg-gray-100 rounded">&lt;NODE2_IP&gt;</td>
                        </tr>
                        <tr>
                            <td class="px-6 py-4 whitespace-nowrap">Node 3</td>
                            <td class="px-6 py-4 whitespace-nowrap font-mono text-sm bg-gray-100 rounded">&lt;NODE3_HOSTNAME&gt;</td>
                            <td class="px-6 py-4 whitespace-nowrap font-mono text-sm bg-gray-100 rounded">&lt;NODE3_IP&gt;</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- STAGE 1 -->
        <section id="stage-1" class="mb-12">
            <h2 class="text-3xl font-bold text-blue-700 border-b-2 border-blue-600 pb-3 mb-6">‚öôÔ∏è STAGE 1: BASIC SYSTEM PREPARATION</h2>
            <p class="font-medium text-gray-700 mb-4"><strong>Status:</strong> Must be executed on all three servers (&lt;NODE1_HOSTNAME&gt;, &lt;NODE2_HOSTNAME&gt;, &lt;NODE3_HOSTNAME&gt;).</p>
            
            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">A. Update System and Install Required Packages</h3>
            <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo apt-get update
sudo apt-get upgrade -y
sudo apt-get install -y gnupg curl net-tools</code></pre>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">B. Set Timezone to UTC</h3>
            <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo timedatectl set-timezone UTC</code></pre>
            
            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">C. Edit the /etc/hosts File</h3>
            <p>On each server, open the <code>/etc/hosts</code> file and add the IP and name of all three servers:</p>
            <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo nano /etc/hosts</code></pre>
            <p>Add the following to the file:</p>
            <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>&lt;NODE1_IP&gt; &lt;NODE1_HOSTNAME&gt;
&lt;NODE2_IP&gt; &lt;NODE2_HOSTNAME&gt;
&lt;NODE3_IP&gt; &lt;NODE3_HOSTNAME&gt;</code></pre>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">D. Mounting the Dedicated Disk for Graylog Data (/dev/sdb)</h3>
            <p>This step assumes you have an additional disk at <code>/dev/sdb</code>.</p>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Format the Disk and Create Mount Point:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo mkfs.ext4 /dev/sdb
sudo mkdir -p /var/lib/graylog-datanode</code></pre>
                </li>
                <li>
                    <p>Add the disk to <code>fstab</code> for automatic mounting on reboot:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>DISK_UUID=$(sudo blkid -s UUID -o value /dev/sdb)
echo "UUID=$DISK_UUID /var/lib/graylog-datanode ext4 defaults 0 2" | sudo tee -a /etc/fstab</code></pre>
                </li>
                <li>
                    <p>Mount the Disk and Verify:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo mount -a
df -h /var/lib/graylog-datanode</code></pre>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">E. Adjust Kernel Parameters</h3>
            <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>echo 'vm.max_map_count=262144' | sudo tee -a /etc/sysctl.d/99-graylog-datanode.conf
sudo sysctl --system</code></pre>
        </section>

        <!-- STAGE 2 -->
        <section id="stage-2" class="mb-12">
            <h2 class="text-3xl font-bold text-blue-700 border-b-2 border-blue-600 pb-3 mb-6">üóÉÔ∏è STAGE 2: MONGODB CLUSTER SETUP (REPLICA SET)</h2>
            
            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">A. Install MongoDB (On All Three Servers)</h3>
            
            <blockquote class="border-l-4 border-blue-400 bg-blue-50 p-4 my-4 rounded-r-lg">
                <p class="font-bold text-blue-800">üí° Important Note:</p>
                <p class="text-blue-700">This guide uses commands for MongoDB 8.0. Always refer to the official Graylog documentation (and their MongoDB guides) for the latest versions and official installation instructions:
                <br>
                <a href="https://go2docs.graylog.org/current/downloading_and_installing_graylog/ubuntu_installation_multi_node.htm" class="text-blue-600 hover:underline" target="_blank" rel="noopener noreferrer">https://go2docs.graylog.org/current/downloading_and_installing_graylog/ubuntu_installation_multi_node.htm</a>
                </p>
            </blockquote>

            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Download and Add the GPG Key:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>curl -fsSL https://www.mongodb.org/static/pgp/server-8.0.asc | sudo gpg -o /usr/share/keyrings/mongodb-server-8.0.gpg --dearmor</code></pre>
                </li>
                <li>
                    <p>Add the Repository List:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>echo "deb [ arch=amd64,arm64 signed-by=/usr/share/keyrings/mongodb-server-8.0.gpg ] https://repo.mongodb.org/apt/ubuntu jammy/mongodb-org/8.0 multiverse" | sudo tee /etc/apt/sources.list.d/mongodb-org-8.0.list</code></pre>
                </li>
                <li>
                    <p>Update Package List:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo apt-get update</code></pre>
                </li>
                <li>
                    <p>Install and Hold Version:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo apt-get install -y mongodb-org
sudo apt-mark hold mongodb-org</code></pre>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">B. MongoDB Configuration (On All Three Servers)</h3>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Edit the <code>/etc/mongod.conf</code> file:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo nano /etc/mongod.conf</code></pre>
                </li>
                <li>
                    <p>Change/ensure the file content is as follows. The <code>bindIp</code>, <code>storage</code> (8GB RAM), and <code>replication</code> sections are crucial.</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code class="language-yaml"># /etc/mongod.conf file content

# Store data in /var/lib/mongodb
storage:
  dbPath: /var/lib/mongodb
  journal:
    enabled: true
  # PROD: Limit MongoDB to 8GB for 32GB RAM
  wiredTiger:
    engineConfig:
      cacheSizeGB: 8

# Log messages to /var/log/mongodb/mongod.log
systemLog:
  destination: file
  logAppend: true
  path: /var/log/mongodb/mongod.log

# Listen on all interfaces
net:
  port: 27017
  bindIp: 0.0.0.0 # Use this instead of 127.0.0.1

# Enable replication
replication:
  replSetName: rs0

processManagement:
  timeZoneInfo: /usr/share/zoneinfo</code></pre>
                </li>
                <li>
                    <p>Start the Service:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo systemctl daemon-reload
sudo systemctl enable mongod.service
sudo systemctl start mongod.service</code></pre>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">C. Initializing the Replica Set (On <code>&lt;NODE1_HOSTNAME&gt;</code> ONLY!)</h3>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Access the MongoDB Shell:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo mongosh</code></pre>
                </li>
                <li>
                    <p>Initiate the replica set:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code class="language-javascript">rs.initiate(
  {
    _id: "rs0",
    members: [
      { _id: 0, host: "<NODE1_HOSTNAME>:27017" },
      { _id: 1, host: "<NODE2_HOSTNAME>:27017" },
      { _id: 2, host: "<NODE3_HOSTNAME>:27017" }
    ]
  }
)</code></pre>
                </li>
                <li>
                    <p>Check the status. After a few seconds, the <code>&lt;NODE1_HOSTNAME&gt;</code> server should become <code>PRIMARY</code>:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code class="language-javascript">rs.status()</code></pre>
                </li>
                <li>
                    <p>Exit the console: <code>exit</code></p>
                </li>
            </ol>
        </section>

        <!-- STAGE 3 -->
        <section id="stage-3" class="mb-12">
            <h2 class="text-3xl font-bold text-blue-700 border-b-2 border-blue-600 pb-3 mb-6">üíæ STAGE 3: GRAYLOG DATA NODE INSTALLATION</h2>
            
            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">A. Installation (On All Three Servers)</h3>
            
            <blockquote class="border-l-4 border-blue-400 bg-blue-50 p-4 my-4 rounded-r-lg">
                <p class="font-bold text-blue-800">üí° Important Note:</p>
                <p class="text-blue-700">This guide shows the Graylog 6.3 repository. Always check the official installation documents for the latest supported repository link:
                <br>
                <a href="https://go2docs.graylog.org/current/downloading_and_installing_graylog/ubuntu_installation_multi_node.htm" class="text-blue-600 hover:underline" target="_blank" rel="noopener noreferrer">https://go2docs.graylog.org/current/downloading_and_installing_graylog/ubuntu_installation_multi_node.htm</a>
                </p>
            </blockquote>

            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Add the Graylog Repository:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>wget https://packages.graylog2.org/repo/packages/graylog-6.3-repository_latest.deb
sudo dpkg -i graylog-6.3-repository_latest.deb
sudo apt-get update</code></pre>
                </li>
                <li>
                    <p>Install the Data Node package:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo apt-get install -y graylog-datanode</code></pre>
                </li>
                <li>
                    <p>Set Data Directory Permissions:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo chown -R graylog-datanode:graylog-datanode /var/lib/graylog-datanode</code></pre>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">B. Prepare the Password Secret (On <code>&lt;NODE1_HOSTNAME&gt;</code> ONLY!)</h3>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Create the <code>password_secret</code>:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>openssl rand -hex 32</code></pre>
                </li>
                <li>
                    <p>Copy the result (e.g., <code>6588f6c4...</code>). This is needed for Stage 3C and 4D.</p>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">C. Configuration (On All Three Servers)</h3>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Edit the <code>/etc/graylog/datanode/datanode.conf</code> file:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo nano /etc/graylog/datanode/datanode.conf</code></pre>
                </li>
                <li>
                    <p>Add/modify the following parameters:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code class="language-properties"># Place the secret you created in Stage 3B here!
password_secret = YOUR_PASSWORD_SECRET_VALUE

# MongoDB HA connection
mongodb_uri = mongodb://<NODE1_HOSTNAME>:27017,<NODE2_HOSTNAME>:27017,<NODE3_HOSTNAME>:27017/graylog?replicaSet=rs0

# PROD: Memory allocation for 32GB RAM (12 GB)
opensearch_heap = 12g

# Path to your disk
opensearch_data_location = /var/lib/graylog-datanode/opensearch/data</code></pre>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">D. Start the Data Node Service (On All Three Servers)</h3>
            <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo systemctl daemon-reload
sudo systemctl enable graylog-datanode.service
sudo systemctl start graylog-datanode.service</code></pre>
        </section>

        <!-- STAGE 4 -->
        <section id="stage-4" class="mb-12">
            <h2 class="text-3xl font-bold text-blue-700 border-b-2 border-blue-600 pb-3 mb-6">üñ•Ô∏è STAGE 4: GRAYLOG SERVER INSTALLATION</h2>
            
            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">A. Installation (On All Three Servers)</h3>
            <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo apt-get install -y graylog-server</code></pre>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">B. Graylog Server Memory (Heap) Configuration (On All Three Servers)</h3>
            <p>For a production environment, we must also allocate stable memory for the Graylog Server itself.</p>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Create/edit the <code>/etc/default/graylog-server</code> file:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo nano /etc/default/graylog-server</code></pre>
                </li>
                <li>
                    <p>Add the following line to the file (PROD: 8GB heap for 32GB RAM):</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code># PROD: 8GB heap for 32GB RAM and G1GC optimization
GRAYLOG_SERVER_JAVA_OPTS="-Xms8g -Xmx8g -XX:+UseG1GC -XX:MaxGCPauseMillis=200 -Djava.net.preferIPv4Stack=true"</code></pre>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">C. Create the Root Password (On <code>&lt;NODE1_HOSTNAME&gt;</code> ONLY!)</h3>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Choose a password for the <code>admin</code> web user (e.g., <code>Hallex28</code>) and create its SHA-256 hash:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>echo -n "Hallex28" | sha256sum | cut -d" " -f1</code></pre>
                </li>
                <li>
                    <p>Copy the result (e.g., <code>8d1770466...</code>). This is needed for Stage 4D.</p>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">D. server.conf Configuration (Different Leadership on Each Server!)</h3>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Edit the <code>/etc/graylog/server/server.conf</code> file:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo nano /etc/graylog/server/server.conf</code></pre>
                </li>
                <li>
                    <p><strong>Parameters that MUST BE THE SAME on all three servers:</strong></p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code class="language-properties"># The secret you created in Stage 3B
password_secret = YOUR_PASSWORD_SECRET_VALUE

# The admin password hash you created in Stage 4C
root_password_sha2 = YOUR_ROOT_PASSWORD_SHA2_HASH

# Web interface listen address
http_bind_address = 0.0.0.0:9000

# External web interface address (Always points to the leader)
http_external_uri = http://<NODE1_IP>:9000/

# MongoDB HA connection
mongodb_uri = mongodb://<NODE1_HOSTNAME>:27017,<NODE2_HOSTNAME>:27017,<NODE3_HOSTNAME>:27017/graylog?replicaSet=rs0

message_journal_max_size = 5gb
processor_wait_strategy = blocking</code></pre>
                </li>
                <li>
                    <p><strong>LEADERSHIP parameters (DIFFERENT on each server):</strong></p>
                    <ul class="list-disc list-inside ml-4 space-y-2">
                        <li>
                            <p><strong>On <code>&lt;NODE1_HOSTNAME&gt;</code> ONLY:</strong></p>
                            <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code class="language-properties">is_leader = true</code></pre>
                        </li>
                        <li>
                            <p><strong>On <code>&lt;NODE2_HOSTNAME&gt;</code> and <code>&lt;NODE3_HOSTNAME&gt;</code>:</strong></p>
                            <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code class="language-properties">is_leader = false</code></pre>
                        </li>
                    </ul>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">E. Start the Server Service (On All Three Servers)</h3>
            <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo systemctl daemon-reload
sudo systemctl enable graylog-server.service
sudo systemctl start graylog-server.service</code></pre>
        </section>

        <!-- STAGE 5 -->
        <section id="stage-5" class="mb-12">
            <h2 class="text-3xl font-bold text-blue-700 border-b-2 border-blue-600 pb-3 mb-6">‚úÖ STAGE 5: FINAL SETUP AND TEST</h2>
            
            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">A. Accessing the Web Interface</h3>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Open the Leader Node's address in your browser: 
                    <br>
                    <a href="http://<NODE1_IP>:9000/" class="text-blue-600 hover:underline font-mono" target="_blank" rel="noopener noreferrer">http://&lt;NODE1_IP&gt;:9000/</a>
                    </p>
                </li>
                <li>
                    <p><strong>Initial Setup (On First Login):</strong></p>
                    <ul class="list-disc list-inside ml-4 space-y-1 text-gray-700">
                        <li>You may see an "Initial Setup" page on your first login. This is related to the Data Node's internal security and is normal.</li>
                        <li>Click the <code>Provision certificates for your data nodes</code> button/link on the page.</li>
                        <li>Wait for the process to complete and then click <code>Configuration finished</code>. The servers may restart.</li>
                    </ul>
                </li>
                <li>
                    <p><strong>Login Page:</strong></p>
                    <ul class="list-disc list-inside ml-4 space-y-1 text-gray-700">
                        <li><strong>Username:</strong> <code>admin</code></li>
                        <li><strong>Password:</strong> The password you chose in Stage 4C (e.g., <code>Hallex28</code>)</li>
                    </ul>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">B. Create an Input for Log Ingestion (Web UI)</h3>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>In the Web UI, go to <strong>System</strong> &gt; <strong>Inputs</strong>.</li>
                <li>Select <code>GELF UDP</code> from the <strong>Select input</strong> list and click <strong>Launch new input</strong>.</li>
                <li>
                    <p>Configure as follows:</p>
                    <ul class="list-disc list-inside ml-4 space-y-1 text-gray-700">
                        <li><strong>Node:</strong> <code>global</code> (To run on all servers)</li>
                        <li><strong>Title:</strong> <code>Test GELF Input</code></li>
                        <li><strong>Bind address:</strong> <code>0.0.0.0</code></li>
                        <li><strong>Port:</strong> <code>5000</code></li>
                    </ul>
                </li>
                <li>Click <strong>Save</strong>.</li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">C. Sending a Test Log (From <code>&lt;NODE1_HOSTNAME&gt;</code>)</h3>
            <ol class="list-decimal list-inside space-y-4 mt-4">
                <li>
                    <p>Install the <code>ncat</code> tool:</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>sudo apt install ncat -y</code></pre>
                </li>
                <li>
                    <p>Send a test log to the cluster (to the leader's IP):</p>
                    <pre><button class="copy-btn" onclick="copyCode(this)">Copy</button><code>echo -n '{"version": "1.1","host":"test-client","short_message":"Graylog Cluster Test Log Successful!","level":1}' | ncat -u -w 1 &lt;NODE1_IP&gt; 5000</code></pre>
                </li>
            </ol>

            <h3 class="text-xl font-semibold text-gray-800 mt-8 mb-3">D. Verifying the Result (Web UI)</h3>
            <p>Go to the <strong>Search</strong> page in the Graylog Web UI. You should see your message: "Graylog Cluster Test Log Successful!"</p>

            <div class="mt-8 p-6 bg-green-50 border border-green-200 rounded-lg">
                <h3 class="text-2xl font-bold text-green-800">üéâ Congratulations!</h3>
                <p class="text-green-700 mt-2">You have successfully installed a 3-Node HA Graylog Cluster.</p>
            </div>
        </section>

    </div>

    <!-- JavaScript for Copy Button -->
    <script>
        function copyCode(button) {
            const pre = button.parentElement;
            const code = pre.querySelector('code');
            const text = code.innerText;

            // Use a temporary textarea to copy
            const textArea = document.createElement('textarea');
            textArea.value = text;
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                // Use execCommand as navigator.clipboard might be blocked in iframes
                document.execCommand('copy');
                button.innerText = 'Copied!';
                button.classList.add('copy-success');
                setTimeout(() => {
                    button.innerText = 'Copy';
                    button.classList.remove('copy-success');
                }, 2000);
            } catch (err) {
                console.error('Failed to copy text: ', err);
                button.innerText = 'Failed!';
                setTimeout(() => {
                    button.innerText = 'Copy';
                }, 2000);
            }
            document.body.removeChild(textArea);
        }
    </script>

</body>
</html>